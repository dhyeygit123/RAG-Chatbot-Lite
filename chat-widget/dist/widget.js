/*! For license information please see widget.js.LICENSE.txt */
(()=>{function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function e(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach(function(n){o(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function o(t,n,e){return(n=d(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function i(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",a=e.toStringTag||"@@toStringTag";function s(e,o,i,a){var s=o&&o.prototype instanceof d?o:d,l=Object.create(s.prototype);return r(l,"_invoke",function(e,o,i){var r,a,s,d=0,l=i||[],h=!1,u={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,a=0,s=t,u.n=e,c}};function p(e,o){for(a=e,s=o,n=0;!h&&d&&!i&&n<l.length;n++){var i,r=l[n],p=u.p,b=r[2];e>3?(i=b===o)&&(s=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(a=0,u.v=o,u.n=r[1]):p<b&&(i=e<3||r[0]>o||o>b)&&(r[4]=e,r[5]=o,u.n=b,a=0))}if(i||e>1)return c;throw h=!0,o}return function(i,l,b){if(d>1)throw TypeError("Generator is already running");for(h&&1===l&&p(l,b),a=l,s=b;(n=a<2?t:s)||!h;){r||(a?a<3?(a>1&&(u.n=-1),p(a,s)):u.n=s:u.v=s);try{if(d=2,r){if(a||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,a<2&&(a=0)}else 1===a&&(n=r.return)&&n.call(r),a<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),a=1);r=t}else if((n=(h=u.n<0)?s:e.call(o,u))!==c)break}catch(n){r=t,a=1,s=n}finally{d=1}}return{value:n,done:h}}}(e,i,a),!0),l}var c={};function d(){}function l(){}function h(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),p=h.prototype=d.prototype=Object.create(u);function b(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,r(t,a,"GeneratorFunction")),t.prototype=Object.create(p),t}return l.prototype=h,r(p,"constructor",h),r(h,"constructor",l),l.displayName="GeneratorFunction",r(h,a,"GeneratorFunction"),r(p),r(p,a,"Generator"),r(p,o,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:s,m:b}})()}function r(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}r=function(t,n,e,o){function a(n,e){r(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(a("next",0),a("throw",1),a("return",2))},r(t,n,e,o)}function a(t,n,e,o,i,r,a){try{var s=t[r](a),c=s.value}catch(t){return void e(t)}s.done?n(c):Promise.resolve(c).then(o,i)}function s(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function s(t){a(r,o,i,s,c,"next",t)}function c(t){a(r,o,i,s,c,"throw",t)}s(void 0)})}}function c(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,d(o.key),o)}}function d(n){var e=function(n){if("object"!=t(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var o=e.call(n,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==t(e)?e:e+""}!function(){"use strict";var t="http://localhost:5000/api",n=function(){return n=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.embedKey=n,this.isOpen=!1,this.sessionId=this.generateSessionId(),this.settings={botName:"Support Bot",welcomeMessage:"Hi! How can I help you today?",themeColor:"#3b82f6",position:"right"},this.messages=[],this.init()},o=[{key:"generateSessionId",value:function(){return"session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}},{key:"init",value:(d=s(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.fetchSettings();case 1:this.injectStyles(),this.createWidget(),this.attachEventListeners();case 2:return t.a(2)}},t,this)})),function(){return d.apply(this,arguments)})},{key:"fetchSettings",value:(a=s(i().m(function n(){var o,r,a;return i().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,fetch("".concat(t,"/chat/settings/").concat(this.embedKey));case 1:return o=n.v,n.n=2,o.json();case 2:(r=n.v)&&r.settings&&(this.settings=e(e({},this.settings),r.settings)),n.n=4;break;case 3:n.p=3,a=n.v,console.error("Failed to fetch chatbot settings:",a);case 4:return n.a(2)}},n,this,[[0,3]])})),function(){return a.apply(this,arguments)})},{key:"injectStyles",value:function(){var t=document.createElement("style");t.textContent="\n        .chatbot-widget * {\n          box-sizing: border-box;\n          margin: 0;\n          padding: 0;\n        }\n        \n        .chatbot-widget {\n          position: fixed;\n          bottom: 20px;\n          ".concat(this.settings.position,": 20px;\n          z-index: 999999;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n        }\n        \n        .chatbot-button {\n          width: 60px;\n          height: 60px;\n          border-radius: 50%;\n          background: ").concat(this.settings.themeColor,";\n          border: none;\n          cursor: pointer;\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: transform 0.2s, box-shadow 0.2s;\n        }\n        \n        .chatbot-button:hover {\n          transform: scale(1.05);\n          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);\n        }\n        \n        .chatbot-button svg {\n          width: 28px;\n          height: 28px;\n          fill: white;\n        }\n        \n        .chatbot-window {\n          position: absolute;\n          bottom: 80px;\n          ").concat(this.settings.position,": 0;\n          width: 380px;\n          height: 600px;\n          background: white;\n          border-radius: 12px;\n          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);\n          display: none;\n          flex-direction: column;\n          overflow: hidden;\n          animation: slideUp 0.3s ease-out;\n        }\n        \n        @keyframes slideUp {\n          from {\n            opacity: 0;\n            transform: translateY(20px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .chatbot-window.open {\n          display: flex;\n        }\n        \n        .chatbot-header {\n          background: ").concat(this.settings.themeColor,";\n          color: white;\n          padding: 16px;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n        }\n        \n        .chatbot-header-title {\n          font-weight: 600;\n          font-size: 16px;\n        }\n        \n        .chatbot-close {\n          background: none;\n          border: none;\n          color: white;\n          cursor: pointer;\n          padding: 4px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          opacity: 0.8;\n          transition: opacity 0.2s;\n        }\n        \n        .chatbot-close:hover {\n          opacity: 1;\n        }\n        \n        .chatbot-messages {\n          flex: 1;\n          overflow-y: auto;\n          padding: 16px;\n          background: #f9fafb;\n        }\n        \n        .chatbot-message {\n          margin-bottom: 12px;\n          display: flex;\n          animation: fadeIn 0.3s ease-out;\n        }\n        \n        @keyframes fadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        .chatbot-message.user {\n          justify-content: flex-end;\n        }\n        \n        .chatbot-message.bot {\n          justify-content: flex-start;\n        }\n        \n        .chatbot-message-content {\n          max-width: 75%;\n          padding: 10px 14px;\n          border-radius: 12px;\n          font-size: 14px;\n          line-height: 1.4;\n        }\n        \n        .chatbot-message.user .chatbot-message-content {\n          background: ").concat(this.settings.themeColor,";\n          color: white;\n          border-bottom-right-radius: 4px;\n        }\n        \n        .chatbot-message.bot .chatbot-message-content {\n          background: white;\n          color: #374151;\n          border-bottom-left-radius: 4px;\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n        }\n        \n        .chatbot-typing {\n          display: none;\n          padding: 10px 14px;\n          background: white;\n          border-radius: 12px;\n          max-width: 75px;\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n        }\n        \n        .chatbot-typing.active {\n          display: block;\n        }\n        \n        .chatbot-typing-dots {\n          display: flex;\n          gap: 4px;\n        }\n        \n        .chatbot-typing-dot {\n          width: 8px;\n          height: 8px;\n          border-radius: 50%;\n          background: #9ca3af;\n          animation: typing 1.4s infinite;\n        }\n        \n        .chatbot-typing-dot:nth-child(2) {\n          animation-delay: 0.2s;\n        }\n        \n        .chatbot-typing-dot:nth-child(3) {\n          animation-delay: 0.4s;\n        }\n        \n        @keyframes typing {\n          0%, 60%, 100% {\n            transform: translateY(0);\n            opacity: 0.7;\n          }\n          30% {\n            transform: translateY(-10px);\n            opacity: 1;\n          }\n        }\n        \n        .chatbot-input-area {\n          padding: 16px;\n          background: white;\n          border-top: 1px solid #e5e7eb;\n        }\n        \n        .chatbot-input-form {\n          display: flex;\n          gap: 8px;\n        }\n        \n        .chatbot-input {\n          flex: 1;\n          padding: 10px 14px;\n          border: 1px solid #d1d5db;\n          border-radius: 8px;\n          font-size: 14px;\n          outline: none;\n          transition: border-color 0.2s;\n        }\n        \n        .chatbot-input:focus {\n          border-color: ").concat(this.settings.themeColor,";\n        }\n        \n        .chatbot-send {\n          padding: 10px 16px;\n          background: ").concat(this.settings.themeColor,";\n          color: white;\n          border: none;\n          border-radius: 8px;\n          cursor: pointer;\n          font-weight: 500;\n          font-size: 14px;\n          transition: opacity 0.2s;\n        }\n        \n        .chatbot-send:hover {\n          opacity: 0.9;\n        }\n        \n        .chatbot-send:disabled {\n          opacity: 0.5;\n          cursor: not-allowed;\n        }\n        \n        @media (max-width: 480px) {\n          .chatbot-window {\n            width: calc(100vw - 40px);\n            height: calc(100vh - 100px);\n            bottom: 10px;\n            left: 20px !important;\n            right: 20px !important;\n          }\n        }\n      "),document.head.appendChild(t)}},{key:"createWidget",value:function(){var t=document.createElement("div");t.className="chatbot-widget",t.innerHTML='\n        <button class="chatbot-button" aria-label="Open chat">\n          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n          </svg>\n        </button>\n        \n        <div class="chatbot-window" role="dialog" aria-label="Chat window">\n          <div class="chatbot-header">\n            <div class="chatbot-header-title">'.concat(this.settings.botName,'</div>\n            <button class="chatbot-close" aria-label="Close chat">\n              <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>\n              </svg>\n            </button>\n          </div>\n          \n          <div class="chatbot-messages" id="chatbot-messages">\n            <div class="chatbot-message bot">\n              <div class="chatbot-message-content">\n                ').concat(this.settings.welcomeMessage,'\n              </div>\n            </div>\n            <div class="chatbot-typing">\n              <div class="chatbot-typing-dots" aria-hidden="true">\n                <div class="chatbot-typing-dot"></div>\n                <div class="chatbot-typing-dot"></div>\n                <div class="chatbot-typing-dot"></div>\n              </div>\n            </div>\n          </div>\n          \n          <div class="chatbot-input-area">\n            <form class="chatbot-input-form" id="chatbot-form" aria-label="Chat input form">\n              <input \n                type="text" \n                class="chatbot-input" \n                id="chatbot-input"\n                placeholder="Type your message..."\n                autocomplete="off"\n                aria-label="Message input"\n              />\n              <button type="submit" class="chatbot-send" aria-label="Send message">Send</button>\n            </form>\n          </div>\n        </div>\n      '),document.body.appendChild(t),this.container=t}},{key:"attachEventListeners",value:function(){var t=this,n=this.container.querySelector(".chatbot-button"),e=this.container.querySelector(".chatbot-close"),o=this.container.querySelector("#chatbot-form");n&&e&&o?(n.addEventListener("click",function(){return t.toggleWidget()}),e.addEventListener("click",function(){return t.toggleWidget()}),o.addEventListener("submit",function(n){return t.handleSubmit(n)})):console.error("Chatbot widget DOM not found â€” createWidget did not run correctly.",{button:n,closeBtn:e,form:o})}},{key:"toggleWidget",value:function(){this.isOpen=!this.isOpen;var t=this.container.querySelector(".chatbot-window");this.isOpen?(t.classList.add("open"),this.container.querySelector("#chatbot-input").focus()):t.classList.remove("open")}},{key:"handleSubmit",value:(r=s(i().m(function n(e){var o,r,a,s,c,d=this;return i().w(function(n){for(;;)switch(n.p=n.n){case 0:if(e.preventDefault(),o=this.container.querySelector("#chatbot-input"),r=o.value.trim()){n.n=1;break}return n.a(2);case 1:return this.addMessage(r,"user"),o.value="",this.showTyping(),n.p=2,n.n=3,fetch("".concat(t,"/chat/query"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({embedKey:this.embedKey,message:r,sessionId:this.sessionId})});case 3:return a=n.v,n.n=4,a.json();case 4:s=n.v,setTimeout(function(){d.hideTyping(),d.addMessage(s.response||"Sorry, I could not process your request.","bot")},500),n.n=6;break;case 5:n.p=5,c=n.v,console.error("Failed to send message:",c),this.hideTyping(),this.addMessage("Sorry, something went wrong. Please try again.","bot");case 6:return n.a(2)}},n,this,[[2,5]])})),function(t){return r.apply(this,arguments)})},{key:"addMessage",value:function(t,n){var e=this.container.querySelector("#chatbot-messages"),o=document.createElement("div");o.className="chatbot-message ".concat(n),o.innerHTML='\n        <div class="chatbot-message-content">'.concat(this.escapeHtml(t),"</div>\n      ");var i=e.querySelector(".chatbot-typing");e.insertBefore(o,i),e.scrollTop=e.scrollHeight}},{key:"showTyping",value:function(){this.container.querySelector(".chatbot-typing").classList.add("active");var t=this.container.querySelector("#chatbot-messages");t.scrollTop=t.scrollHeight}},{key:"hideTyping",value:function(){this.container.querySelector(".chatbot-typing").classList.remove("active")}},{key:"escapeHtml",value:function(t){var n=document.createElement("div");return n.textContent=t,n.innerHTML}}],o&&c(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,r,a,d}();"string"==typeof window.ChatbotWidget?(console.warn("Overwriting string window.ChatbotWidget with object to initialize widget"),window.ChatbotWidget={}):window.ChatbotWidget=window.ChatbotWidget||{},window.ChatbotWidget.init=function(t){if(t)try{new n(t)}catch(t){console.error("Failed to initialize ChatbotWidget:",t)}else console.error("Chatbot Widget: Embed key is required")};try{window.chatbot&&window.chatbot.q&&window.chatbot.q.forEach(function(t){"init"===t[0]&&window.ChatbotWidget.init(t[1])})}catch(t){console.warn("Error checking window.chatbot queue:",t)}try{window.cb&&window.cb.q&&window.cb.q.forEach(function(t){"init"===t[0]&&window.ChatbotWidget.init(t[1])})}catch(t){console.warn("Error checking window.cb queue:",t)}"string"!=typeof window.chatbot?window.chatbot=function(){var t=Array.prototype.slice.call(arguments);"init"===t[0]?window.ChatbotWidget.init(t[1]):(window.chatbot.q=window.chatbot.q||[],window.chatbot.q.push(t))}:console.warn("window.chatbot is a string; not overwriting to avoid conflicts."),"string"!=typeof window.cb?window.cb=function(){var t=Array.prototype.slice.call(arguments);"init"===t[0]?window.ChatbotWidget.init(t[1]):(window.cb.q=window.cb.q||[],window.cb.q.push(t))}:console.warn("window.cb is a string; not overwriting to avoid conflicts.")}()})();